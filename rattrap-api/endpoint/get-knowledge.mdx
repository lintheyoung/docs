---
title: '获取知识库文件'
openapi: 'GET /knowledge-base/{id}'
---

<RequestExample>
```bash cURL
curl https://lrsppxarhxvxcflougbp.supabase.co/functions/v1/knowledge-base/kb_1a2b3c4d5e6f7g8h \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzMyNjE4MDAwLCJpYXQiOjE3MzI2MTQ0MDAsImlzcyI6Imh0dHBzOi8vbHJzcHB4YXJoeHZ4Y2Zsb3VnYnAuc3VwYWJhc2UuY28iLCJzdWIiOiJ1c2VyLWlkLWhlcmUifQ.xxx"
```

```javascript Node.js
const response = await fetch(
  "https://lrsppxarhxvxcflougbp.supabase.co/functions/v1/knowledge-base/kb_1a2b3c4d5e6f7g8h",
  {
    method: "GET",
    headers: {
      "Authorization": `Bearer ${accessToken}`,
    },
  }
);

const knowledgeEntry = await response.json();
console.log(`知识标题: ${knowledgeEntry.title}`);
```

```python Python
import requests

response = requests.get(
    "https://lrsppxarhxvxcflougbp.supabase.co/functions/v1/knowledge-base/kb_1a2b3c4d5e6f7g8h",
    headers={
        "Authorization": f"Bearer {access_token}",
    }
)

knowledge_entry = response.json()
print(f"知识标题: {knowledge_entry['title']}")
```
</RequestExample>

<ResponseExample>
```json 成功响应 - 文本知识
{
  "id": "kb_1a2b3c4d5e6f7g8h",
  "tenant_id": "tenant_abc123",
  "title": "老鼠基础知识",
  "content": "老鼠是常见的城市害虫，分为家鼠和田鼠两大类...",
  "content_type": "document",
  "source_file_name": "mouse_knowledge.txt",
  "source_file_type": "txt",
  "source_url": "https://example.com/mouse-guide",
  "access_level": "internal",
  "category": "rodent_knowledge",
  "tags": ["老鼠习性", "防治方法"],
  "language": "zh",
  "visibility": "private",
  "is_active": true,
  "usage_count": 42,
  "created_by": "user_123",
  "created_at": "2025-12-08T10:30:00Z",
  "updated_at": "2025-12-08T10:30:00Z"
}
```

```json 成功响应 - 图片知识
{
  "id": "kb_9z8y7x6w5v4u3t2s",
  "tenant_id": "tenant_abc123",
  "title": "充电口位置示意图",
  "content": "图片展示了 RatTrap Pro 捕鼠器底部的 USB-C 充电口位置，位于电源开关旁边...",
  "content_type": "image",
  "source_file_name": "charging_port.jpg",
  "source_file_type": "jpg",
  "image_url": "https://storage.rattrap.ai/knowledge/kb_9z8y7x6w5v4u3t2s.jpg",
  "source_url": "https://rattrap.com/manual/charging",
  "access_level": "public",
  "category": "trap_usage",
  "tags": ["充电", "使用说明"],
  "language": "zh",
  "visibility": "public",
  "is_active": true,
  "usage_count": 128,
  "created_by": "user_123",
  "created_at": "2025-12-08T10:35:00Z",
  "updated_at": "2025-12-08T10:35:00Z"
}
```

```json 错误响应 - 未授权
{
  "error": {
    "type": "authentication_error",
    "code": "UNAUTHORIZED",
    "message": "Invalid or missing authentication token",
    "doc_url": "https://docs.rattrap.ai/errors#unauthorized"
  }
}
```

```json 错误响应 - 知识不存在
{
  "error": {
    "type": "not_found_error",
    "code": "NOT_FOUND",
    "message": "Knowledge entry not found",
    "param": "id",
    "doc_url": "https://docs.rattrap.ai/errors#not_found"
  }
}
```

```json 错误响应 - 无访问权限
{
  "error": {
    "type": "permission_error",
    "code": "FORBIDDEN",
    "message": "You don't have permission to access this knowledge entry",
    "doc_url": "https://docs.rattrap.ai/errors#forbidden"
  }
}
```
</ResponseExample>

## 使用说明

通过此接口可以获取单个知识库条目的详细信息。支持获取文本、图片等各种类型的知识内容。

<CardGroup cols={3}>
  <Card title="完整信息" icon="file-lines">
    返回知识条目的所有元数据和内容
  </Card>
  <Card title="权限检查" icon="shield">
    自动验证用户对知识条目的访问权限
  </Card>
  <Card title="使用统计" icon="chart-bar">
    返回知识条目的使用次数等统计信息
  </Card>
</CardGroup>

## 请求参数

### 路径参数

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| `id` | string | 是 | 知识库条目 ID，格式：`kb_xxx` |

## 访问权限规则

<Info>
**权限检查逻辑**：
1. `visibility='public'` 的知识：所有已登录用户均可访问
2. `visibility='private'` 的知识：仅同租户用户可访问
3. 管理员可以访问所有知识（包括其他租户的私有知识）
</Info>

## 响应字段说明

| 字段 | 类型 | 说明 |
|------|------|------|
| `id` | string | 知识库条目 ID，格式：`kb_xxx` |
| `tenant_id` | string | 租户 ID（private 模式）或 `null`（public 模式） |
| `title` | string | 知识标题 |
| `content` | string | 知识内容（文本或图片描述） |
| `content_type` | string | 内容类型：`document` / `image` / `text` / `qa` |
| `source_file_name` | string | 原始文件名 |
| `source_file_type` | string | 文件类型：`txt` / `jpg` / `png` / `pdf` / `docx` |
| `image_url` | string | 图片公开 URL（仅图片类型） |
| `source_url` | string | 原始来源 URL |
| `source_title` | string | 来源标题 |
| `access_level` | string | 访问权限级别：`public` / `internal` / `private` |
| `category` | string | 知识分类 |
| `tags` | string[] | 标签数组 |
| `language` | string | 语言代码 |
| `visibility` | string | 隐私级别：`private` / `public` |
| `is_active` | boolean | 是否启用 |
| `usage_count` | integer | 使用次数 |
| `created_by` | string | 创建者用户 ID |
| `created_at` | string | 创建时间（ISO 8601） |
| `updated_at` | string | 更新时间（ISO 8601） |

<Info>
**向量字段**：`embedding` 字段（1536 维向量）不会在响应中返回，因为它仅用于后端检索。
</Info>

## 错误码

| HTTP 状态码 | 错误代码 | 说明 |
|-----------|---------|------|
| 401 | `UNAUTHORIZED` | 未提供有效的认证 Token |
| 403 | `FORBIDDEN` | 无权访问此知识条目（租户权限不匹配） |
| 404 | `NOT_FOUND` | 知识条目不存在或已被删除 |
| 500 | `INTERNAL_ERROR` | 服务器内部错误 |

## 常见问题

<AccordionGroup>
  <Accordion title="为什么我获取不到某个知识条目？">
    可能的原因：
    1. 知识条目 ID 错误或不存在
    2. 知识条目为 `visibility='private'`，且你不属于该租户
    3. 知识条目已被删除
  </Accordion>

  <Accordion title="如何获取知识列表？">
    使用知识列表接口 `GET /knowledge-base`，支持分页、筛选和搜索。详见知识列表接口文档。
  </Accordion>

  <Accordion title="usage_count 是什么？">
    `usage_count` 表示该知识条目被 RAG 问答系统引用的次数。每次用户提问时，如果该知识被作为上下文使用，计数会 +1。
  </Accordion>
</AccordionGroup>

## 相关资源

- **上传知识库文件**：[/knowledge-upload](/rattrap-api/endpoint/knowledge-upload) - 上传新的知识条目
- **删除知识库文件**：[/knowledge-base/{id}](/rattrap-api/endpoint/delete-knowledge) - 删除知识条目
- **RAG 知识问答系统**：[/rag-qa](/rattrap-api/endpoint/rag-qa) - 查询知识库并生成回答
